# 用于多人体姿态检测的级联金字塔

# 概括

​	最近，多人姿态估计的任务得到了很大的提升，特别是随着卷积神经网络的发展。然而，仍然存在许多具有挑战性的案例，例如被遮挡的关键点，不可见的关键点和复杂的背景，这些都无法很好地解决。在本文中，我们提出了一种称为级联金字塔网络（CPN）的新型网络结构，旨在从这些“难”关键点解决问题。更具体地说，我们的算法包括两个阶段：GlobalNet和RefineNet。 GlobalNet是一个功能金字塔网络，可以成功地定位“简单”的关键点，如眼睛和手，但可能无法精确识别被遮挡或不可见的关键点。我们的RefineNet通过整合来自Global-Net的所有级别的特征表示以及在线’难‘关键点挖掘损失，尝试明确处理“难”关键点。通常，为了解决多人姿势估计问题，采用自上而下的流水线来首先基于检测器生成一组人类边界框，然后是我们的CPN，用于在每个人类边界框中进行关键点定位。基于所提出的算法，我们在COCO关键点基准测试中获得了最新结果，COCO测试数据集的平均精度为73.0，COCO测试挑战数据集的平均精度为72.1，与COCO 2016关键点挑战中的60.5相比有19%的提高。 Code1和检测结果可供公众进一步研究。

# 1.简介

​	多人姿势估计是识别和定位图像中所有人的关键点，这是许多视觉应用（如人类动作识别和人机交互）的基础研究课题。
​	最近，多人姿势估计的问题由于深层卷积神经网络的参与而大大改善。例如，在[5]中，卷积姿势机器用于定位图像中的关键点关节，并且提出部分亲和力场（PAF）以将关节组装到不同的人。 Mask-RCNN [15]首先预测人类边界框，然后根据人类边界框扭曲特征图以获得人类关键点。 虽然已经取得了很大进展，但仍然存在许多具有挑战性的案例，例如被遮挡的关键点，不可见的关键点和拥挤的背景，这些都无法很好地进行定位。 主要原因在于两点：1）这些“难”关节不能仅根据其外观特征进行简单识别，例如，躯干点; 2）这些“难”关节在训练过程中没有明确解决。

​	为了解决这些“难”关节，在本文中，我们提出了一种称为级联金字塔网络（CPN）的新型网络结构。我们的网络架构分为两个阶段：GlobalNet和RefineNet。我们的GlobalNet基于特征金字塔网络[24]学习了一个很好的特征表示。更重要的是，金字塔特征表示可以提供足够的上下文信息，这对于被遮挡和不可见关节的推断是不可避免的。基于金字塔特征，我们的RefineNet基于在线硬关键点损失挖掘明确地解决了“难”关节问题。
​	基于我们的级联金字塔网络，我们基于自上而下的管道解决了多人姿势估计问题。人体探测器首先用于生成一组人类边界框，然后是我们的CPN，用于在每个人类边界框中进行关键点定位。此外，我们还探讨了可能影响多人姿态估计性能的各种因素的影响，包括人体探测器和数据预处理。这些细节对于进一步提高算法的准确性和鲁棒性非常有用。

总之，我们的贡献有以下三个方面：
• 我们提出了一种新颖有效的网络，称为级联金字塔网络（CPN），它集成了整体金字塔网络（GlobalNet）和基于在线'难‘关键点挖掘的金字塔精确网络（RefineNet）
• 我们探讨了自上而下运行过程中涉及多人姿态估计的不同因素的影响。
• 我们的算法在COCO竞赛多人关键点基准测试中获得最新的成果，即测试-开发数据集中的73.0 AP和测试挑战数据集中的72.1 AP。

# 2.相关工作

​    几十年来，人体姿势估计是一个活跃的研究课题。解决人体姿态估计问题的经典方法主要采用光子结构技术[10,1]或图形模型[7]。更具体地说，经典著作[1,34,13,33,8,44,29,20]将人类关键点估计问题表述为树状结构或图形模型问题，并基于手工制作预测关键点位置特征。最近的工作[27,14,4,19,39,42]主要依赖于卷积神经网络（CNN）的发展[22,16]，这在很大程度上改善了姿态估计的性能。在本文中，我们主要关注基于卷积神经网络的方法。该主题被分类为单人姿势估计，其基于给定边界框的裁剪图像来预测人体关键点，以及需要进一步识别一个图像中的所有人的全身姿势的多人姿势估计。
​	**多人姿态估计**。由于对现实应用的高需求，最近多人姿势估计越来越受欢迎。然而，由于遮挡，个体的各种姿势以及不同人之间不可预测的相互作用，多人姿势估计具有挑战性。多人姿态估计的方法主要分为两类：自下而上方法和自上而下方法。
​	**自下而上的方法**。自下而上的方法[5,26,30,19]首先直接预测所有关键点，并将它们组合成所有人的完整姿势。 DeepCut [30]解释了将图像中的不同人区分为整数线性编程（ILP）问题并将部分检测候选分区为人群的问题。然后，当人物聚类与标记的身体部位组合时，获得最终的姿势估计结果。 DeeperCut [19]使用更深层次的ResNet [16]改进了DeepCut [30]，并采用图像条件成对技术来获得更好的性能。哲曹等人， [5]将关键点之间的关系映射到部分亲和力场（PAF），并将检测到的关键点组合成不同的人体姿势。纽厄尔等人， [26]同时产生得分图和逐像素嵌入以将候选关键点分组给不同的人以获得最终的多人姿势估计。	

​	**自上而下的方法**。自上而下的方法[28,18,15,9]将关键点检测过程解释为两阶段通道，即首先从图像中定位和裁剪所有人，然后在被裁减的图片上解决单人姿势估计问题。帕潘德里欧等人， [28]预测热图和热图上的点到实际位置的偏移值，然后使用带有偏移的热图来获得关键点的最终预测位置。 Mask-RCNN [15]首先预测人类边界框，然后裁剪相应人类边界框的特征图来预测人类关键点。如果自上而下的方法用于多人姿势估计，人体探测器以及单人姿势估计器对于获得良好的性能非常重要。在这里，我们回顾一些关于单人姿势估计和最新的检测方法。

​	**单人姿态估计**。 Toshev等人，首先引入CNN来解决DeepPose [38]工作中的姿态估计问题，该问题提出了CNN姿态回归器的级联来处理姿态估计。 Tompson等人， [37]试图通过使用CNN和图形模型预测关键点的热图来解决问题。后来如魏等人的工作中，[27]通过使用非常深的卷积神经网络生成关键点的得分图，获得了很好的表现。魏等人， [40]提出了一种多阶段架构，即首先生成粗略结果，并在以下阶段中不断优化结果。纽厄尔等人， [27]提出了一种U形网络，即沙漏模块，并堆叠几个沙漏模块以产生预测。 Carreira等，[6]使用迭代误差反馈来获得姿势估计并逐步优化预测。 Lifshitz等，[23]使用深度共识投票来投票关键点最可能的位置。 Gkioxary[14]和Zisserman等人， [2]应用类似RNN的架构来顺序细化结果。我们的工作部分是受到生成和改进分数图的启发。杨等人， [43]在姿态估计过程中采用金字塔特征作为网络的输入，这是对姿态估计中金字塔特征利用的一种很好的探索。然而，在姿势估计中金字塔结构需要更多的细化操作。

​	**人体检测**。 人体检测方法主要由RCNN家族[12,11,31]指导，其最新探测器为[24,15]。 这些检测方法通常由两个阶段组成。 首先根据默认锚点生成框提议，然后从特征图中裁剪并进一步细化提议以通过R-CNN网络获得最终框。 我们的方法中使用的探测器大多基于[24,15]。



![](https://raw.githubusercontent.com/lxy5513/Markdown_image_dateset/master/Xnip2018-11-26_09-12-24.png)